if(typeof AH_Version==="undefined"){var AH_Version=20141110}var AH={domain:"ffxiah.com",url:"http://static.ffxiah.com",apiurl:"http://api.ffxiah.com",headNode:document.getElementsByTagName("head").item(0),timer:null,defaultLang:"en",games:["ffxi","ffxiv"],langs:["en","jp","de","fr"],addCSS:function(file){var linkNode=document.createElement("link");linkNode.setAttribute("rel","stylesheet");linkNode.setAttribute("href",file);linkNode.setAttribute("type","text/css");this.headNode.appendChild(linkNode)},jsonp:{currentScript:null,getJSON:function(url,data,callback){var src=url+(url.indexOf("?")+1?"&":"?");var head=document.getElementsByTagName("head")[0];var newScript=document.createElement("script");var params=[];var param_name="";this.success=callback;data["callback"]="AH.jsonp.success";for(param_name in data){params.push(param_name+"="+encodeURIComponent(data[param_name]))}src+=params.join("&");newScript.type="text/javascript";newScript.src=src;if(this.currentScript)head.removeChild(currentScript);head.appendChild(newScript)},success:null},insertAfter:function(referenceNode,newNode){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling)},isDescendant:function(parent,child){var node=child.parentNode;while(node!=null){if(node.nodeName.toLowerCase()==parent.toLowerCase()){return true}node=node.parentNode}return false},addJS:function(file,body){var jsNode=document.createElement("script");jsNode.setAttribute("src",file);jsNode.setAttribute("type","text/javascript");if(body){document.getElementsByTagName("body").item(0).appendChild(jsNode)}else{this.headNode.appendChild(jsNode)}},domReady:function(callback){var self=this;if(/WebKit/i.test(window.navigator.userAgent)){self.timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(self.timer);callback()}},100)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){callback()},false)}else if(document.all&&!window.opera){document.write('<script type="text/javascript" id="contentloadtag" defer="defer" src="javascript:void(0)"></script>');var contentloadtag=document.getElementById("contentloadtag");contentloadtag.onreadystatechange=function(){if(this.readyState=="complete"){callback()}}}},log:function(str){var console=document.getElementById("ah-console");var html=console.innerHTML;html+=str+"<br />";console.innerHTML=html},getLang:function(s){for(var i in this.langs){if(this.langs[i]==s)return s}return this.defaultLang},load:function(url,callback){var xhr;if(typeof XMLHttpRequest!=="undefined")xhr=new XMLHttpRequest;else{var versions=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(var i=0,len=versions.length;i<len;i++){try{xhr=new ActiveXObject(versions[i]);break}catch(e){}}}xhr.onreadystatechange=ensureReadiness;function ensureReadiness(){if(xhr.readyState<4){return}if(xhr.status!==200){return}if(xhr.readyState===4){callback(xhr)}}xhr.open("GET",url,true);xhr.send("")}};if(window.location.hostname.match(/.*\.dev$/)){AH.url=window.location.hostname}AH.Tooltip={elementid:"AH_TT",classname:"AH_TT",offsetxpoint:10,offsetypoint:20,ie:document.all,ns6:document.getElementById&&!document.all,enabletip:false,inited:false,tipobj:null,lastpos:null,init:function(classname){var self=AH.Tooltip;if(document.getElementById(self.elementid)==null){var div=document.createElement("div");div.setAttribute("id",self.elementid);if(classname!=null){self.classname=classname}div.setAttribute("class",self.classname);window.document.body.appendChild(div)}if(self.ie||self.ns6){self.tipobj=document.all?document.all[self.elementid]:document.getElementById?document.getElementById(self.elementid):""}document.onmousemove=function(e){self.position(e)};self.inited=true},iebody:function(){return document.compatMode&&document.compatMode!="BackCompat"?document.documentElement:document.body},f_clientHeight:function(){var self=this;return self.f_filterResults(window.innerHeight?window.innerHeight:0,document.documentElement?document.documentElement.clientHeight:0,document.body?document.body.clientHeight:0)},f_scrollTop:function(){var self=this;return self.f_filterResults(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)},f_filterResults:function(n_win,n_docel,n_body){var n_result=n_win?n_win:0;if(n_docel&&(!n_result||n_result>n_docel))n_result=n_docel;return n_body&&(!n_result||n_result>n_body)?n_body:n_result},show:function(thetext,thecolor,thewidth){var self=AH.Tooltip;if(!self.inited)self.init();if(self.ns6||self.ie){if(typeof thewidth!="undefined")self.tipobj.style.width=thewidth+"px";if(typeof thecolor!="undefined"&&thecolor!="")self.tipobj.style.backgroundColor=thecolor;if(typeof thetext=="function"){self.tipobj.innerHTML=thetext()}else{self.tipobj.innerHTML=thetext}self.enabletip=true;return false}},position:function(e){var self=AH.Tooltip;self.lastpos=e;if(self.enabletip){var curX=self.ns6?e.pageX:event.clientX+self.iebody().scrollLeft;var curY=self.ns6?e.pageY:event.clientY+self.iebody().scrollTop;var sTop=self.f_scrollTop();var wHeight=self.f_clientHeight();var baseline=sTop+wHeight;var rightedge=self.ie&&!window.opera?self.iebody().clientWidth-event.clientX-self.offsetxpoint:window.innerWidth-e.clientX-self.offsetxpoint-20;var bottomedge=self.ie&&!window.opera?wHeight-event.clientY-self.offsetypoint:wHeight-e.clientY-self.offsetypoint;var leftedge=self.offsetxpoint<0?self.offsetxpoint*-1:-1e3;var posX;if(rightedge<self.tipobj.offsetWidth){self.tipobj.style.left=self.ie?self.iebody().scrollLeft+event.clientX-self.tipobj.offsetWidth+"px":window.pageXOffset+e.clientX-self.tipobj.offsetWidth+"px"}else if(curX<leftedge){self.tipobj.style.left="5px"}else{self.tipobj.style.left=curX+self.offsetxpoint+"px"}if(bottomedge<self.tipobj.offsetHeight-20-3){if(curY+self.tipobj.offsetHeight+self.offsetypoint>=baseline){self.tipobj.style.top=self.tipobj.offsetHeight>=wHeight?sTop+"px":baseline-self.tipobj.offsetHeight-self.offsetypoint+"px"}else{self.tipobj.style.top=self.ie?sTop+event.clientY-self.tipobj.offsetHeight-self.offsetypoint+"px":sTop+e.clientY-self.tipobj.offsetHeight-self.offsetypoint+"px"}}else{self.tipobj.style.top=curY+self.offsetypoint+"px"}self.tipobj.style.visibility="visible";self.tipobj.style.display="block"}},hide:function(){var self=this;if(!self.inited)return;if(self.ns6||self.ie){self.enabletip=false;self.tipobj.style.display="none";self.tipobj.style.visibility="hidden";self.tipobj.style.left="-1000px";self.tipobj.style.backgroundColor="";self.tipobj.style.width=""}}};AH.Tips={timer:0,currTip:"",inited:false,bodyRef:null,cssFile:"/css//syndicate.css",data:[],types:["item"],init:function(){var self=AH.Tips;if(self.inited)return;for(var g in AH.games){self.data[AH.games[g]]=[];for(var i in AH.langs){self.data[AH.games[g]][AH.langs[i]]=[];for(var j in self.types){self.data[AH.games[g]][AH.langs[i]][self.types[j]]=[]}}}self.inited=true;self.bodyRef=document.getElementsByTagName("body").item(0);if(!(typeof AH_Version==="undefined")){self.cssFile="default.css"}AH.addCSS(self.cssFile);self.addTips()},addTips:function(){var self=this;if(!self.inited){self.init();return}var links=document.getElementsByTagName("a");for(var i=0;i<links.length;i++){var args=[];var AL=links[i].href.match(/^http:\/\/ffera\.com\/items\.php\?id=([0-9]+)/);if(AL==null)continue;if(AL[1]>="0"){args["game"]="ffxi"}else if(AL[1]=="vpro"){args["game"]="ffxi"}else{continue}args["lang"]="en";args["type"]="item";args["id"]=AL[1];self.removeEvent(links[i],"mouseover",AH.Tips.show);self.removeEvent(links[i],"mouseout",AH.Tips.hide);self.addevent(links[i],"mouseover",AH.Tips.show,args);self.addevent(links[i],"mouseout",AH.Tips.hide,[])}},hide:function(){return function(){var self=AH.Tips;if(self.timer&&self.timer>0){window.clearInterval(self.timer);self.timer=0}AH.Tooltip.hide()}},show:function(args){return function(){var self=AH.Tips;if(self.timer&&self.timer>0){window.clearInterval(self.timer);self.timer=0}var tipId=args["game"]+"_"+args["lang"]+"_"+args["type"]+"_"+args["id"];if(self.currTip==tipId){AH.Tooltip.enabletip=true;AH.Tooltip.position(AH.Tooltip.lastpos);return}else if(self.isRegistered(args)){AH.Tooltip.show(self.data[args["game"]][args["lang"]][args["type"]][args["id"]]);if(self.data[args["game"]][args["lang"]][args["type"]][args["id"]]!="Loading..."){self.currTip=tipId}}else{self.fetch(args)}var func=AH.Tips.show(args);self.timer=window.setInterval(func,50)}},isRegistered:function(args){return typeof AH.Tips.data[args["game"]][args["lang"]][args["type"]][args["id"]]!="undefined"},fetch:function(args){AH.Tips.data[args["game"]][args["lang"]][args["type"]][args["id"]]="Loading...";AH.addJS(AH.apiurl+"/tt/?v=3&game=ffxi&lang=en&type=item&id="+args["id"])},addevent:function(element,event,func,argumentsArray){if(typeof func=="string"){func=window[func]}if(typeof element=="string"){element=document.getElementById(element)}if(!element||typeof event!="string"||typeof func!="function"){return false}event=event.toLowerCase();if(typeof element["addEventListener"]!="undefined"){if(event.indexOf("on")>-1){event=event.replace(/^on/,"")}element.addEventListener(event,func(argumentsArray),false);return true}else if(typeof element["attachEvent"]!="undefined"){if(event.indexOf("on")!=0){event="on"+event}element.attachEvent(event,func(argumentsArray));return true}else{if(event.indexOf("on")!=0){event="on"+event}element[event]=func(argumentsArray)}return false},removeEvent:function(element,event,func){if(typeof func=="string"){func=window[func]}if(typeof element=="string"){element=document.getElementById(element)}if(!element||typeof event!="string"||typeof func!="function"){return false}event=event.toLowerCase();if(typeof element["addEventListener"]!="undefined"){if(event.indexOf("on")>-1){event=event.replace(/^on/,"")}element.removeEventListener(event,func,false);return true}else if(typeof element["attachEvent"]!="undefined"){if(event.indexOf("on")!=0){event="on"+event}element.detachEvent(event,func);return true}else{if(event.indexOf("on")!=0){event="on"+event}element[event]=false}return false}};AH.Reactor={elements:[],types:["equipbox","itemlist","node"],data:{},init:function(){this.initData();this.loadObjects(this.getElements())},initData:function(){for(var i=0;i<AH.langs.length;i++){this.data[AH.langs[i]]={};for(var j=0;j<AH.games.length;j++){this.data[AH.langs[i]][AH.games[j]]={};for(var k=0;k<this.types.length;k++){this.data[AH.langs[i]][AH.games[j]][this.types[k]]={}}}}},loadObjects:function(elements){if(!elements)return;for(var i=0;i<elements.length;i++){var method="";var url="";switch(elements[i]["type"]){case"equipbox":url="/"+elements[i]["game"]+"/itemset/";method="getEquipBox";break;case"itemlist":url="/"+elements[i]["game"]+"/itemset/";method="getItemList";break;case"node":url="/node/";method="getNodeContent";break}if(method&&url){this.loadObject(elements[i],method,url)}}},callback:function(d){if(d["id"]&&d["lang"]&&d["game"]&&d["type"]){try{var obj=AH.Reactor.data[d["lang"]][d["game"]][d["type"]][d["id"]];obj.data=d.data;AH.Reactor.renderObject(obj)}catch(err){}}},loadObject:function(el,method,url){var obj=this.data[el["lang"]][el["game"]][el["type"]][el["id"]];if(!obj){this.data[el["lang"]][el["game"]][el["type"]][el["id"]]={load:[{el:el["el"]}]};var data={game:el["game"],type:el["type"],id:el["id"],lang:el["lang"],method:method};AH.jsonp.getJSON(AH.apiurl+url,data,AH.Reactor.callback)}else{obj.load.push({el:el["el"]});this.renderObject(obj)}},renderObject:function(obj){if(!obj["load"]||obj["load"].length===0)return;var len=obj.load.length;while(len--){if(obj["load"][len].done||!obj.data)continue;var div=document.createElement("div");div.innerHTML=obj.data;var parent=obj.load[len].el.parentNode;parent.insertBefore(div,obj.load[len].el);obj.load[len].done=true;parent.removeChild(obj.load[len].el);this.loadObjects(this.getElements(div))}AH.Tips.addTips();if(typeof Site!="undefined"){Site.autoFormat()}},getElements:function(node){var skip_node_type=false;if(!node){node=document}else{skip_node_type=true}var elements=[];var links=node.getElementsByTagName("a");for(var i=0;i<links.length;i++){var args={};if(links[i].hasAttribute("data-ffxiah-skip"))continue;for(var j=0;j<this.types.length;j++){if(skip_node_type&&this.types[j]=="node")continue;if(links[i].hasAttribute("data-ffxiah-"+this.types[j])){args["type"]=this.types[j];break}}if(!args["type"])continue;if(AH.isDescendant("pre",links[i]))continue;var AL=links[i].href.match(/^https?:\/\/(www|jp|fr|de|es)?\.?ffxi(ah|vpro)\.com\/(item\-sets|node)\/([0-9]+)/);if(AL==null)continue;if(AL[2]=="ah"){args["game"]="ffxi"}else if(AL[2]=="vpro"){args["game"]="ffxiv"}else{continue}args["lang"]=AH.getLang(AL[1]);args["id"]=AL[4];args["el"]=links[i];elements.push(args)}return elements}};AH.domReady(function(){AH.Tooltip.init();AH.Tips.init();AH.Reactor.init()});